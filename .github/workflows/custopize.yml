name: "CustoPiZe"

on:
  workflow_dispatch:

jobs:
  build:
    name: "Build"
    runs-on: ubuntu-latest
    steps:

    - name: "‚¨á Checkout"
      uses: actions/checkout@v2

    - name: "‚¨á Download OctoPi"
      id: octopi_download
      run: |
        mkdir build
        cd build
        wget https://github.com/guysoft/OctoPi/releases/download/0.18.0/octopi-buster-armhf-lite-0.18.0.zip -O octopi.zip
        
        unzip octopi.zip
        rm octopi.zip

        IMAGE=$(ls *.img | head -n 1)
        mv $IMAGE input.img

    - name: "üèó Run CustoPiZer"
      uses: OctoPrint/CustoPiZer@main
      with:
        workspace: "${{ github.workspace }}/build"
        scripts: "${{ github.workspace }}/scripts"
        config: "${{ github.workspace }}/config.local"
